image: node:22

options:
  max-time: 20
  size: 2x

pipelines:
  branches:
    master:
      - step:
          name: Install & Test (Master branch)
          caches:
            - node
          script:
            - echo "ðŸ›  Installing dependencies (legacy peer deps to avoid conflicts)..."
            - npm ci --legacy-peer-deps
            - echo "ðŸ§ª Running tests..."
            - npm run test:ci
          artifacts:
            - coverage/**
definitions:
  caches:
    node: ~/.npm
